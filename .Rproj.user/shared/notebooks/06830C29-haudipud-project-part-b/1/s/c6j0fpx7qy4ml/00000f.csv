"0","library(EBImage)"
"0","library(dplyr)"
"0",""
"0","# Get all image paths"
"0","img_paths <- list.files(""ProjectData_ForClass_v2-3"", pattern = "".jpg$"", full.names = TRUE, recursive = TRUE)"
"0",""
"0","# Feature extractor"
"0","extract_features <- function(img_path) {"
"0","  img <- readImage(img_path)"
"0","  gray <- channel(img, ""gray"")"
"0","  resized <- resize(gray, 32, 32)"
"0","  vec <- as.vector(resized)"
"0","  image_name <- basename(img_path)"
"0","  return(data.frame(t(vec), image = image_name, stringsAsFactors = FALSE))"
"0","}"
"0",""
"0","# Extract from all images"
"0","feature_list <- lapply(img_paths, extract_features)"
"0","features_df <- bind_rows(feature_list)"
"0",""
"0","# Save"
"0","save(features_df, file = ""Output/features.RData"")"
"0",""
